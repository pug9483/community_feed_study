# community_feed_service


## 📁 프로젝트 구조

```plaintext
src
 ├─ main
 │   ├─ java
 │   │   ├─ config          # 공통 설정
 │   │   ├─ domain          # 핵심 도메인 모델 및 로직
 │   │   ├─ application     # 서비스 레이어 (Use Case)
 │   │   ├─ interface       # 컨트롤러, DTO, REST API
 │   │   ├─ infrastructure  # 영속성, 외부 연동
 │   └─ resources
 │       └─ application.yml # 설정 파일
 └─ test
     └─ java               # 단위 및 인수 테스트
```

---

## 🧑‍🤝‍🧑 유저(User) 메인 서비스

### 1. 유저 생성

- 사용자 구분: 고유 `id`
- 입력 필드: `name` (빈 값 불가), `profileImage`
- 예외 처리: 이름이 빈 값이면 등록 실패

### 2. 팔로우(Follow) 기능

1. **팔로우/언팔로우**
   - 사용자는 다른 사용자를 팔로우하거나 취소 가능
   - 자기 자신은 팔로우 불가
2. **도메인과 레이어 책임 분리**
   - 자기 자신 검증: 도메인 레벨에서 처리
   - 팔로우 여부 확인: 레포지토리 레벨에서 처리
3. **트랜잭션 처리**
   - 팔로우 상태 저장 및 카운트 증감은 하나의 트랜잭션으로 처리
   - 팔로우/팔로잉 카운트가 0 이하로 떨어지지 않도록 검증

### 3. 프로필 노출

- 노출 정보
   - `name`, `profileImage`
   - 팔로잉 수, 팔로워 수
   - 팔로잉/팔로워 리스트 (각 사용자 `name`, `profileImage`)
- 리스트 조회 시 팔로잉/팔로워 숫자 클릭으로 상세 리스트 노출

---

## 📰 피드(Feed) 서비스

### 1. 게시물(Post) 작성

- 입력
   - 텍스트: 5자 이상, 500자 이하
   - 공개 대상: `ALL`, `FOLLOWERS`
- 예외 처리: 글자 수 범위 벗어날 시 오류 반환

### 2. 댓글(Comment) 작성

- 입력: 텍스트 최대 100자
- 예외 처리: 글자 수 초과 시 오류 반환

### 3. 게시물 상호작용

- 좋아요(Like)
   - 본인 게시물은 좋아요 불가
- 댓글 작성 및 좋아요
- 수정
   - 작성자만 수정 가능
   - 수정 여부(`edited`)와 수정 시간(`editedAt`) 저장

### 4. 피드 조회

- 팔로우한 사용자의 게시물을 최신 순으로 페이징 조회
- 응답 데이터
   - 게시물 내용, 작성자 정보, 좋아요/댓글 개수
   - 수정 여부, 발행 일자, 나의 좋아요 여부

### 5. 댓글 리스트 조회

- 응답 데이터
   - 작성자 정보, 댓글 내용, 좋아요 개수
   - 수정 여부, 발행 일자, 나의 좋아요 여부

---

## 🔄 팔로우 로직 상세 흐름

1. 입력값 검증: 팔로우 대상 유저 존재 여부
2. 이미 팔로우 상태인지 확인 (Repository)
3. 자기 자신 여부 검증 (Domain)
4. 트랜잭션 시작
   - 팔로우 상태 저장/삭제
   - 팔로우/팔로잉 카운트 증감
5. 트랜잭션 커밋

---

## 📦 계층별 책임 (Layered Architecture)

| 계층              | 책임                                       |
|------------------|------------------------------------------|
| Controller       | REST API 엔드포인트 정의                 |
| Service (UseCase)| 비즈니스 로직 orchestration               |
| Domain           | 엔티티, 도메인 로직, 검증                |
| Repository       | DB 접근 (CRUD)                           |
| DTO              | 요청/응답 데이터 객체                    |

---

## 📌 기술 스택

- **Java**: 17
- **Spring Boot**: 3.3.1
- **MySQL**: 8.0.11
- **테스트**: JUnit 5, Mockito
